# rect should contain 4 coord in seq: top left, top right, bot right, bot left
# vect should contain 2 coord [x y], [x y]  -> left right


def pos_point(vect: [], x, y):
    xn = x - vect[0][0]
    yn = y - vect[0][1]
    vx = vect[1][0] - vect[0][0]
    vy = vect[1][1] - vect[0][1]
    y_exp = vy / vx * xn
    return yn > y_exp


def is_inside(rect: [], x, y):
    if not pos_point([rect[0], rect[1]], x, y):
        return False
    if pos_point([rect[3], rect[2]], x, y):
        return False
    rect_3 = [rect[3][1], rect[3][0]]
    rect_0 = [rect[0][1], rect[0][0]]
    if not pos_point([rect_0, rect_3], y, x):
        return False
    rect_2 = [rect[2][1], rect[1][0]]
    rect_1 = [rect[1][1], rect[2][0]]
    if pos_point([rect_1, rect_2], y, x):
        return False
    return True


def on_lane(vec: [], x):
    fpx = vec[0][0] if vec[0][0] < vec[1][0] else vec[1][0]
    lpx = vec[0][0] if vec[0][0] > vec[1][0] else vec[1][0]
    if x < fpx or x > lpx:
        return False
    return True


def is_inside_v2(rect: [], x, y):
    ps = 0
    for a in range(4):
        if not on_lane([rect[a % 4], rect[(a + 1) % 4]], x):
            continue
        if not pos_point([rect[a % 4], rect[(a + 1) % 4]], x, y):
            ps += 1
    if ps % 2 == 0:
        return False
    return True


POSITION_LIST = {
    1: [[0.413, 0.202], [0.660, 0.219], [0.592, 0.323], [0.432, 0.293]],
    2: [[0.268, 0.288], [0.412, 0.202], [0.431, 0.293], [0.327, 0.3631]],
    3: [[0.1952, 0.401], [0.268, 0.288], [0.327, 0.3631], [0.279, 0.4308]],
    4: [[0.191, 0.417], [0.274, 0.447], [0.256, 0.556], [0.17, 0.52]],
    5: [[0.171, 0.54], [0.258, 0.536], [0.272, 0.607], [0.1866, 0.6484]],
    6: [[0.1916, 0.652], [0.277, 0.6167], [0.369, 0.712], [0.329, 0.803]],
    7: [[0.3768, 0.722], [0.512, 0.733], [0.531, 0.816], [0.335, 0.8163]],
    8: [[0.5266, 0.7277], [0.6016, 0.6736], [0.652, 0.7305], [0.5475, 0.8076]],
    9: [[0.639, 0.569], [0.706, 0.584], [0.664, 0.714], [0.613, 660]],
    10: [[0.6102, 0.4697], [0.6729, 0.4495], [0.7096, 0.572], [0.639, 0.562]],
    11: [[0.5447, 0.42], [0.585, 0.371], [0.664, 0.443], [0.6035, 0.4674]],
    12: [[0.444, 0.3544], [0.569, 0.363], [0.5403, 0.4135], [0.4546, 0.4056]],
    13: [[0.3616, 0.3948], [0.438, 0.3559], [0.4488, 0.4063], [0.3976, 0.4322]],
    14: [[0.355, 0.3976], [0.394, 0.441], [0.361, 0.495], [0.3062, 0.4834]],
    15: [[0.3026, 0.4913], [0.3573, 0.5043], [0.3624, 0.5698], [0.312, 0.592]],
    16: [[0.3148, 0.59726], [0.3645, 0.577], [0.4142, 0.6354], [0.389, 0.6844]],
    17: [[0.4185, 0.639], [0.5382, 0.6254], [0.5475, 0.6844], [0.3963, 0.6873]],
    18: [[0.4286, 0.4632], [0.5432, 0.4632], [0.5432, 0.5763], [0.4286, 0.5763]],
    0: [[0.7168, 0.1368], [0.9005, 0.1368], [0.9005, 0.3285], [0.7168, 0.3285]],
    -2: [[0.1822, 0.1974], [0.384, 0.1001], [0.4049, 0.1916], [0.2608, 0.2809]],
    -13: [[0.1822, 0.1974], [0.384, 0.1001], [0.4049, 0.1916], [0.2608, 0.2809]],
    -6: [[0.0439, 0.6902], [0.1635, 0.6642], [0.3217, 0.8112], [0.2723, 0.8976]],
    -16: [[0.0439, 0.6902], [0.1635, 0.6642], [0.3217, 0.8112], [0.2723, 0.8976]],
    -10: [[0.6916, 0.4474], [0.8054, 0.3941], [0.8278, 0.5979], [0.7132, 0.5742]],
}


def is_in_field_num(x, y, field_num):
    if field_num > len(POSITION_LIST):
        return False
    return is_inside_v2(POSITION_LIST[field_num], x, y)
